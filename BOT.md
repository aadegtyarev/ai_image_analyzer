–í–æ—Ç —É–¥–æ–±–Ω–∞—è –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è **–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Telegram-–±–æ—Ç–∞**. –ü–æ–¥–æ–π–¥—ë—Ç –∫–∞–∫ README –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

# ü§ñ AI Photo Assistant ‚Äî Telegram –±–æ—Ç

–£–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞.
–£–º–µ–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –¥–∞–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å, –ø–æ–º–æ–≥–∞—Ç—å —Å –∏–¥–µ—è–º–∏ —Å—ä—ë–º–æ–∫ –∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã.
–†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å –æ–¥–∏–Ω–æ—á–Ω—ã–º–∏ —Ñ–æ—Ç–æ, —Ç–∞–∫ –∏ —Å —Å–µ—Ä–∏—è–º–∏.

---

## üìå –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç

–ë–æ—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:

* –æ–¥–Ω–æ —Ñ–æ—Ç–æ
* –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ
* —Ç–µ–∫—Å—Ç
* —Ñ–æ—Ç–æ + —Ç–µ–∫—Å—Ç

–ò –≤ –æ—Ç–≤–µ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç:

* –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä
* –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
* –∏–¥–µ–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Å—ä—ë–º–∫–∏
  –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç–∞ –º–Ω–æ–≥–æ ‚Äî –æ—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ `.txt` —Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è–ª—Å—è.

–ë–æ—Ç **–æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º**, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

---


### ‚ñ∂ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–¥–Ω–æ —Ñ–æ—Ç–æ

–ü—Ä–æ—Å—Ç–æ –ø—Ä–∏—à–ª–∏ —Ñ–æ—Ç–æ –±–æ—Ç—É.

–û–Ω:
‚Ä¢ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –∫ –∞–Ω–∞–ª–∏–∑—É
‚Ä¢ –ø—Ä–∏–º–µ–Ω–∏—Ç –ø—Ä–æ–º—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚Ä¢ –ø—Ä–∏—à–ª—ë—Ç —Ä–∞–∑–±–æ—Ä

---

### ‚ñ∂ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ
–ú–æ–∂–Ω–æ:
## Docker
You can run the bot in Docker using the provided `Dockerfile` and `docker-compose.yml`.

Basic usage:

```bash
docker compose up --build -d
```

Run in debug mode (local development):

### Command order in Telegram

The bot registers commands via Telegram's `setMyCommands` API in the order they are appended in `setup_bot_commands()`.
Note: some Telegram clients may display commands alphabetically or grouped; to control the order reliably, name your prompt files in `prompts/` with a numeric prefix (e.g. `01_art.txt`, `02_portrait.txt`) ‚Äî the bot loads prompts sorted by filename and will register the commands in that order.

```bash
DEBUG=1 IMAGE_DEBUG=1 docker compose up --build
```

Notes:
- `prompts/` and `howto/` are mounted read-only into the container; `db/` is mounted for persistent user data.
- Configure secrets via `.env` (do not commit it to git).

* –ø—Ä–∏—Å–ª–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
* –ø–µ—Ä–µ—Å–ª–∞—Ç—å –∞–ª—å–±–æ–º
* –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –ø–æ–¥—Ä—è–¥

–î–∞–ª–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∂–∏–º–∞:

* –µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω `PER_IMAGE_MODE = true` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å) ‚Üí –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **–∫–∞–∂–¥–æ–µ —Ñ–æ—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ**
* –µ—Å–ª–∏ `false` ‚Üí –±–æ—Ç —Å–æ–±–µ—Ä—ë—Ç **–∫–æ–ª–ª–∞–∂** –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å—ë –≤–º–µ—Å—Ç–µ

---

### ‚ñ∂ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –∫ —Ñ–æ—Ç–æ

–ï—Å–ª–∏ –≤–º–µ—Å—Ç–µ —Å —Ñ–æ—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç (–≤ –ø–æ–¥–ø–∏—Å–∏):

* —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª–∏
* —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
* –æ—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≤ —á–∞—Ç, –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–∫

–ü—Ä–∏–º–µ—Ä:

```
–ü–æ–¥—Å–∫–∞–∂–∏, —á—Ç–æ —è –º–æ–≥—É —É–ª—É—á—à–∏—Ç—å?
```

---

## üéØ –ü—Ä–æ–º—Ç—ã (–≥–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–Ω–∞–ª–∏–∑–∞)

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É `prompts/`
–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –≤–∏–¥–∞:

```
/portrait
/colors
/emotion
/story
...
```

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1Ô∏è‚É£ –ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
2Ô∏è‚É£ –ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–æ—Ç–æ

–ù–∞–ø—Ä–∏–º–µ—Ä:

```
/art
```

‚Üí –±–æ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç `prompts/art.txt`

–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç ‚Äî –æ–Ω –ø–µ—Ä–µ–∫—Ä–æ–µ—Ç –ø—Ä–æ–º—Ç.

---

## ‚úç –†–µ–∂–∏–º —Ç–µ–∫—Å—Ç–∞

### –¢–µ–∫—Å—Ç –±–µ–∑ —Ñ–æ—Ç–æ

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –±–æ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–∏–∞–ª–æ–≥ —Å –º–æ–¥–µ–ª—å—é.

---

### `/text`

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –¥–ª—è —Ñ–æ—Ç–æ

```
/text
–í–æ—Ç —ç—Ç–æ —Ñ–æ—Ç–æ —Å–Ω—è–ª –≤—á–µ—Ä–∞. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?
```

üì∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—à—å —Ñ–æ—Ç–æ
–ú–æ–¥–µ–ª—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–æ—Ç–æ **—Å —É—á—ë—Ç–æ–º —Ç–µ–∫—Å—Ç–∞**, —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

---

### `/text_collage`

–¢–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –µ—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äî –±–æ—Ç —Å–æ–±–µ—Ä—ë—Ç **–∫–æ–ª–ª–∞–∂**.

---

## üìö HowTo ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –∏ –æ–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### `/howto`

–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:

```
üìö lighting
üìö posing
üìö composition
...
```

### `/howto –∏–º—è`

–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π HOWTO (markdown-—Ñ–∞–π–ª –∏–∑ –ø–∞–ø–∫–∏ `howto/`).
–ï—Å–ª–∏ –¥–ª–∏–Ω–Ω—ã–π ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è `.txt`.

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `/stats`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—á–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

* —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–¥–µ–ª–∞–ª
* —Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ
* —Å–∫–æ–ª—å–∫–æ –º–µ–≥–∞–±–∞–π—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ
* —Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–æ
* —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ —É—à–ª–æ

---

## üëë –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã

–î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É:

### üë• –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

```
/users
```

–°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```
/user_add <id>
```

–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
/user_del <id>
```

–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### üßπ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
/stats_reset <user_id>
```

–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### üí≥ –ë–∞–ª–∞–Ω—Å

```
/balance
```

–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å API –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

---

## ‚öôÔ∏è –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã

* –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **–ª–∏—á–∫–µ –∏ —á–∞—Ç–∞—Ö –æ–¥–∏–Ω–∞–∫–æ–≤–æ**
* –º–æ–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ñ–æ—Ç–æ ‚Üí –±–æ—Ç –ø–æ–π–º—ë—Ç
* –¥–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ñ–∞–π–ª–æ–º
* –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤–æ–æ–±—â–µ
* –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –ø—Ä–æ–º—Ç—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏)

---

## ‚úÖ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### üì∏ –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

–û—Ç–ø—Ä–∞–≤–∏–ª —Ñ–æ—Ç–æ ‚Üí –ø–æ–ª—É—á–∏–ª –º–Ω–µ–Ω–∏–µ

---

### üì∑üì∑üì∑ –°–µ—Ä–∏—è –∫–∞–¥—Ä–æ–≤

–û—Ç–ø—Ä–∞–≤–∏–ª 3‚Äì10 —Ñ–æ—Ç–æ
‚Üí –ø–æ–ª—É—á–∏–ª –∞–Ω–∞–ª–∏–∑ —Å–µ—Ä–∏–∏ –∏–ª–∏ –æ—Ç—á—ë—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–æ—Ç–æ

---

### ‚ùì –ó–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å

–ú–æ–∂–Ω–æ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–æ–≤–µ—Ç:

```
–ö–∞–∫ —É–ª—É—á—à–∏—Ç—å —Å–≤–µ—Ç?
–ö–∞–∫–æ–π —Å—Ç–∏–ª—å —Ç—É—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç?
–ö–∞–∫–∏–µ –∏–¥–µ–∏ –º–æ–∂–Ω–æ —Ä–∞–∑–≤–∏—Ç—å?
```

–û–∫, –≤–æ—Ç –ø–æ–Ω—è—Ç–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è **–∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Telegram-–±–æ—Ç–∞**.

---

# üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ AI Photo Assistant Bot

## 1Ô∏è‚É£ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Linux / macOS / Windows
* Python **3.10+**
* –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Telegram-–±–æ—Ç —Ç–æ–∫–µ–Ω –∏–∑ BotFather
* –†–∞–±–æ—á–∏–π `ai_image_analyzer.py` (–ª–µ–∂–∏—Ç —Ä—è–¥–æ–º —Å –±–æ—Ç–æ–º)

---

## 2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–°–æ–∑–¥–∞–π venv (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ):

```bash
python3 -m venv .venv
source .venv/bin/activate     # Linux/macOS
# –∏–ª–∏
.venv\Scripts\activate        # Windows
```

–£—Å—Ç–∞–Ω–æ–≤–∏ –ø–∞–∫–µ—Ç—ã:

```bash
pip install -r requirements.txt
```

–ú–∏–Ω–∏–º—É–º –≤–Ω—É—Ç—Ä–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:

```
aiogram
python-dotenv
Pillow
openai
```

---

## 3Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤—å –ø–∞–ø–∫–∏

```bash
mkdir -p prompts
mkdir -p howto
mkdir -p db
mkdir -p images
```

---

## 4Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π `.env`

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` —Ä—è–¥–æ–º —Å –±–æ—Ç–æ–º:

```
BOT_TOKEN=your_tg_bot_token_here
BOT_ADMIN_ID=123456789
BOT_ADMIN_USERNAME=@yourname

PROMPTS_DIR=prompts
HOWTO_DIR=howto
USERS_FILE=db/users.json

PER_IMAGE_DEFAULT=true
```

‚ÑπÔ∏è `BOT_ADMIN_ID` ‚Äî numeric Telegram user id
–£–∑–Ω–∞—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ [https://t.me/getmyid_bot](https://t.me/getmyid_bot)

---

## 5Ô∏è‚É£ –ù–∞–ø–æ–ª–Ω–∏ prompts

–°—é–¥–∞ –∫–ª–∞–¥—ë—à—å `.txt` —Ñ–∞–π–ª—ã:

```
prompts/
 ‚îú‚îÄ‚îÄ art.txt
 ‚îú‚îÄ‚îÄ portrait.txt
 ‚îî‚îÄ‚îÄ concept.txt
```

–ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç –∫–æ–º–∞–Ω–¥—ã:

```
/art
/portrait
/concept
```

---

## 6Ô∏è‚É£ –î–æ–±–∞–≤—å howto –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

```
howto/
 ‚îú‚îÄ‚îÄ lighting.md
 ‚îú‚îÄ‚îÄ posing.md
 ‚îî‚îÄ‚îÄ workflow.md
```

–î–∞–ª—å—à–µ:

```
/howto
/howto lighting
```

---

## 7Ô∏è‚É£ –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

–ü—Ä–æ—Å—Ç–æ:

```bash
python bot.py
```

–ï—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ ‚Äî —É–≤–∏–¥–∏—à—å –≤ –∫–æ–Ω—Å–æ–ª–∏:

```
Bot is running...
```

---

## 8Ô∏è‚É£ –î–∞–π –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ:

* –∞–¥–º–∏–Ω—É
* —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

–†–∞–∑—Ä–µ—à–∏—Ç—å:

```
/user_add <telegram_user_id>
```

–°–ø–∏—Å–æ–∫:

```
/users
```

–£–¥–∞–ª–∏—Ç—å:

```
/user_del <telegram_user_id>
```

---

## 9Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ ‚Üí –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç üéâ

---

## üêû –û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π DEBUG-—Ñ–ª–∞–≥ –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

- `DEBUG=1` ‚Äî –æ–±—â–∏–π –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥; –ø–µ—á–∞—Ç–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–Ω–∏–ø–ø–µ—Ç—ã system/user prompt –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`[PROMPT_DEBUG]`).
- `IMAGE_DEBUG=1` ‚Äî –ø–µ—á–∞—Ç–∞–µ—Ç –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º (`[IMAGE_DEBUG] image #...`).
 - `DEBUG=1` ‚Äî –æ–±—â–∏–π –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥; –ø–µ—á–∞—Ç–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–Ω–∏–ø–ø–µ—Ç—ã system/user prompt –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`[PROMPT_DEBUG]`).
 - `IMAGE_DEBUG=1` ‚Äî –ø–µ—á–∞—Ç–∞–µ—Ç –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º (`[IMAGE_DEBUG] image #...`).
 - –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `DEBUG=1` —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–º—Ç–∞ –¥–ª—è –∞–ª—å–±–æ–º–æ–≤: `[MEDIA_DEBUG] set media context <media_group_id>:` –∏ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –∫—ç—à–∞: `[MEDIA_DEBUG] expired media context <media_group_id>`.

New: use `group` flag to request collage behavior for any command.

Examples:

* `/art group` ‚Äî for the `art` prompt, build a collage of images and send a single request.
* `/text group` ‚Äî send a text override and request a collage instead of per-image requests.

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```bash
DEBUG=1 IMAGE_DEBUG=1 python bot.py
```

–¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞ `/reload_prompts`, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –≤ `prompts/` –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∑–∞–Ω–æ–≤–æ, –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞.

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ TTL –∫—ç—à–∞ media-group: –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `MEDIA_CONTEXT_TTL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 120 —Å–µ–∫—É–Ω–¥). –ï—Å–ª–∏ –≤—ã —á–∞—Å—Ç–æ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç–µ –∞–ª—å–±–æ–º—ã, —É–≤–µ–ª–∏—á—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

# üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞

–ê–¥–º–∏–Ω –º–æ–∂–µ—Ç:

```
/balance
```

---

# üßπ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ü–æ–∫–∞–∑–∞—Ç—å:

```
/stats
```

–ê–¥–º–∏–Ω:

```
/stats_reset <user_id>
```

---

# ‚öôÔ∏è –†–µ–∂–∏–º—ã

| –î–µ–π—Å—Ç–≤–∏–µ                     | –†–µ–∑—É–ª—å—Ç–∞—Ç               |
| ---------------------------- | ----------------------- |
| –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ               | –ê–Ω–∞–ª–∏–∑                  |
| –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ               | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –ø–æ—à—Ç—É—á–Ω–æ |
| –ï—Å–ª–∏ PER_IMAGE_DEFAULT=false | –ö–æ–ª–ª–∞–∂                  |
| `/text + —Ñ–æ—Ç–æ`               | –¢–µ–∫—Å—Ç –≤–º–µ—Å—Ç–æ –ø—Ä–æ–º—Ç–∞     |
| `/text_collage + —Ñ–æ—Ç–æ`       | –ö–æ–ª–ª–∞–∂ + —Ç–µ–∫—Å—Ç          |
| –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç                 | –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç         |
| `/howto`                     | —Å–ø–∏—Å–æ–∫                  |
| `/howto name`                | —Ç–µ–∫—Å—Ç howto             |

---

# üìå –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

‚úî –±–æ—Ç –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚úî –¥–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∫ `.txt`
‚úî —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª–∏—á–∫–µ –∏ —á–∞—Ç–∞—Ö
‚úî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ç–æ –∏ image-–¥–æ–∫—É–º–µ–Ω—Ç—ã